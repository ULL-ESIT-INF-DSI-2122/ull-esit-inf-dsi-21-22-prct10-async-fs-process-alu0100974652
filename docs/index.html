<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652</title><meta name="description" content="Documentation for ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1> ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652 </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#práctica-10---sistema-de-ficheros-y-creación-de-procesos-en-nodejs" id="práctica-10---sistema-de-ficheros-y-creación-de-procesos-en-nodejs" style="color: inherit; text-decoration: none;">
  <h1>Práctica 10 - Sistema de ficheros y creación de procesos en Node.js</h1>
</a>

<a href="#desarrollo-de-sistemas-informáticos" id="desarrollo-de-sistemas-informáticos" style="color: inherit; text-decoration: none;">
  <h2><em>Desarrollo de Sistemas Informáticos</em></h2>
</a>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652/actions/workflows/build.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652/actions/workflows/build.yml/badge.svg" alt="Build"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652/actions/workflows/node.js.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652/actions/workflows/node.js.yml/badge.svg" alt="Node.js CI"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652/actions/workflows/tests.js.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0100974652/actions/workflows/tests.js.yml/badge.svg" alt="Tests"></a></p>
<p>En esta práctica se plantean una serie de ejercicios o retos a resolver haciendo uso de las APIs proporcionadas por Node.js para interactuar con el sistema de ficheros, así como para crear procesos.</p>
<p>Todo el código desarrollado deberá estar alojado en el repositorio generado tras la aceptación de la asignación de GitHub Classroom. En ese sentido, utilice en dicho repositorio una estructura de proyecto similar a la que hemos visto en clase.</p>
<p>Por último, tendrá que comentar en un informe la solución diseñada para cada ejercicio.</p>

<a href="#ejercicio-1" id="ejercicio-1" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 1</h2>
</a>
<p>Se nos pide crear una traza del siguiente código:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">access</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">, </span><span class="hl-2">watch</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> !== </span><span class="hl-4">3</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Please, specify a file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">} </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">filename</span><span class="hl-1"> = </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">];</span><br/><br/><span class="hl-1">  </span><span class="hl-5">access</span><span class="hl-1">(</span><span class="hl-2">filename</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">.</span><span class="hl-7">F_OK</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> does not exist`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Starting to watch file </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">watcher</span><span class="hl-1"> = </span><span class="hl-5">watch</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">      </span><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been modified somehow`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> is no longer watched`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>
<p><strong><em>Contenido de la pila de llamadas:</em></strong></p>
<pre><code class="language-typescript"><span class="hl-4">1.</span><br/><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> !== </span><span class="hl-4">3</span><span class="hl-1">) {</span><br/><span class="hl-1"> </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Please, specify a file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">2.</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">filename</span><span class="hl-1"> = </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">];</span><br/><span class="hl-5">access</span><span class="hl-1">(</span><span class="hl-2">filename</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">.</span><span class="hl-7">F_OK</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {});</span><br/><span class="hl-4">3.</span><br/><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">   </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> does not exist`</span><span class="hl-1">);</span><br/><span class="hl-1"> } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">   </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Starting to watch file </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1"> }</span><br/><span class="hl-1">   </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">watcher</span><span class="hl-1"> = </span><span class="hl-5">watch</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">]);</span><br/><span class="hl-1">}</span><br/><span class="hl-4">4.</span><br/><br/><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been modified somehow`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><span class="hl-4">5.</span>
</code></pre>
<p>console.log(<code>File ${filename} is no longer watched</code>);
 <strong><em>Registro de eventos de la API:</em></strong></p>
<pre><code class="language-typescript"><span class="hl-4">1.</span><br/><br/><span class="hl-1">(</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> does not exist`</span><span class="hl-1">);</span><br/><span class="hl-1">} </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Starting to watch file </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><span class="hl-1">}</span><br/><span class="hl-4">2.</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">watcher</span><span class="hl-1"> = </span><span class="hl-5">watch</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">]);</span><br/><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1"> </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been modified somehow`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code></pre>
<p><strong><em>Cola de manejadores:</em></strong></p>
<pre><code class="language-typescript"><span class="hl-4">1.</span><br/><br/><span class="hl-1">(</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">   </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> does not exist`</span><span class="hl-1">);</span><br/><span class="hl-1"> } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">   </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Starting to watch file </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1"> }</span><br/><span class="hl-1">}</span><br/><span class="hl-4">2.</span><br/><br/><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been modified somehow`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code></pre>
<p><strong><em>Contenido mostrado por consola:</em></strong></p>
<pre><code class="language-typescript"><span class="hl-4">1.</span><br/><br/><span class="hl-2">Please</span><span class="hl-1">, </span><span class="hl-2">specify</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-2">file</span><span class="hl-1"> \</span><br/><br/><br/><span class="hl-2">Starting</span><span class="hl-1"> </span><span class="hl-2">to</span><span class="hl-1"> </span><span class="hl-2">watch</span><span class="hl-1"> </span><span class="hl-2">file</span><span class="hl-1"> </span><span class="hl-2">helloWorld</span><span class="hl-1">.</span><span class="hl-2">txt</span><span class="hl-1"> \</span><br/><br/><span class="hl-2">File</span><span class="hl-1"> </span><span class="hl-2">helloWorld</span><span class="hl-1">.</span><span class="hl-2">txt</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">no</span><span class="hl-1"> </span><span class="hl-2">longer</span><span class="hl-1"> </span><span class="hl-2">watched</span><span class="hl-1"> \</span><br/><br/><span class="hl-2">File</span><span class="hl-1"> </span><span class="hl-2">helloWorld</span><span class="hl-1">.</span><span class="hl-2">txt</span><span class="hl-1"> </span><span class="hl-2">has</span><span class="hl-1"> </span><span class="hl-2">been</span><span class="hl-1"> </span><span class="hl-2">modified</span><span class="hl-1"> </span><span class="hl-2">somehow</span><span class="hl-1"> \</span><br/><br/><span class="hl-2">File</span><span class="hl-1"> </span><span class="hl-2">helloWorld</span><span class="hl-1">.</span><span class="hl-2">txt</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">no</span><span class="hl-1"> </span><span class="hl-2">longer</span><span class="hl-1"> </span><span class="hl-2">watched</span><span class="hl-1"> \</span><br/><br/><span class="hl-2">File</span><span class="hl-1"> </span><span class="hl-2">helloWorld</span><span class="hl-1">.</span><span class="hl-2">txt</span><span class="hl-1"> </span><span class="hl-2">has</span><span class="hl-1"> </span><span class="hl-2">been</span><span class="hl-1"> </span><span class="hl-2">modified</span><span class="hl-1"> </span><span class="hl-2">somehow</span><span class="hl-1"> \</span><br/><br/><span class="hl-2">File</span><span class="hl-1"> </span><span class="hl-2">helloWorld</span><span class="hl-1">.</span><span class="hl-2">txt</span><span class="hl-1"> </span><span class="hl-2">is</span><span class="hl-1"> </span><span class="hl-2">no</span><span class="hl-1"> </span><span class="hl-2">longer</span><span class="hl-1"> </span><span class="hl-2">watched</span>
</code></pre>
<ul>
<li>¿Qué hace la función access? Determina si existe una ruta y qué permisos tiene un usuario para el archivo o directorio en esa ruta</li>
<li>¿Para qué sirve el objeto constants? Son los modos de permiso que están disponibles como propiedad en el objeto fs.<ul>
<li>fs.constants.F_OK - Tiene permisos de lectura / escritura / ejecución (si no se proporciona ningún modo, este es el valor predeterminado)</li>
<li>fs.constants.R_OK - Tiene permisos de lectura</li>
<li>fs.constants.W_OK - Tiene permisos de escritura</li>
<li>fs.constants.X_OK - Tiene permisos de ejecución (Funciona igual que fs.constants.F_OK en Windows)
<a href="#ejercicio-2" id="ejercicio-2" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 2</h2>
</a>
Implemente un programa que devuelva el número de ocurrencias de una palabra en un fichero de texto. Para acceder al contenido del fichero deberá expandir el comando cat de Unix/Linux, además de expandir el comando grep con la salida proporcionada por cat como entrada para obtener las líneas en las que se encuentra la palabra buscada.</li>
</ul>
</li>
</ul>
<p>Para este ejercicio crearemos una clase llamada GrepCommand, que recibirá como parámetros el fichero y la palabra a entcontrar, que implementará las funciones tanto con tuberia como sin tuberia. Para ello, definiremos dos procesos, cat y grep, con el método spawn, y con la opción -c dentro del comando grep para contar las ocurrencias.
En el caso de la tuberia deberemos comunicar los dos procesos a través del canal de salida del cat.stdout con el canal de entrada de grep.stdin, alamacenamos el resultado dentro de una variable y comparamos la salida de grep.close al cerrar dicho canal. En caso de que la variable sea mayor de 0 querrá decir que existe la palabra dentro del fichero pasado como parámetro</p>
<pre><code class="language-typescript"><span class="hl-5">pipe</span><span class="hl-1">(){</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">existsSync</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-2">filename</span><span class="hl-1">)){</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">cat</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;cat&#39;</span><span class="hl-1">, [</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-2">filename</span><span class="hl-1">]);</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">grep</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;grep&#39;</span><span class="hl-1">, [</span><span class="hl-3">&#39;-c&#39;</span><span class="hl-1">, </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-2">word</span><span class="hl-1">]);</span><br/><span class="hl-1">      </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">pipe</span><span class="hl-1">(</span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-2">stdin</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">grepOutput</span><span class="hl-1"> = </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">piece</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">grepOutput</span><span class="hl-1"> += </span><span class="hl-2">piece</span><span class="hl-1">;</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = +</span><span class="hl-2">grepOutput</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">x</span><span class="hl-1"> &gt; </span><span class="hl-4">0</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-6">this</span><span class="hl-9">.</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3"> esta en </span><span class="hl-6">${</span><span class="hl-2">x</span><span class="hl-6">}</span><span class="hl-3"> lineas del fichero`</span><span class="hl-1">));</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">`La palabra </span><span class="hl-6">${</span><span class="hl-6">this</span><span class="hl-9">.</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3"> no se encuentra en el fichero`</span><span class="hl-1">));</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;El fichero no existe&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span>
</code></pre>
<p>De la otra manera, para realizar el método sin la tubería, será de manera similar a la anterior, lo diferencial será en no poder usar el método pipe(), y conectando correctamente cada uno de los canales.</p>
<pre><code class="language-typescript"><span class="hl-1">  </span><span class="hl-5">nopipe</span><span class="hl-1">(){</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">existsSync</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-2">filename</span><span class="hl-1">)){</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">cat</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;cat&#39;</span><span class="hl-1">, [</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-2">filename</span><span class="hl-1">]);</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">grep</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;grep&#39;</span><span class="hl-1">, [</span><span class="hl-3">&#39;-c&#39;</span><span class="hl-1">, </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-2">word</span><span class="hl-1">]);</span><br/><span class="hl-1">      </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&quot;data&quot;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-2">stdin</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&quot;close&quot;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-2">stdin</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">grepOutput</span><span class="hl-1"> = </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">piece</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">grepOutput</span><span class="hl-1"> += </span><span class="hl-2">piece</span><span class="hl-1">;</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">x</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = +</span><span class="hl-2">grepOutput</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">x</span><span class="hl-1"> &gt; </span><span class="hl-4">0</span><span class="hl-1">){</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-6">this</span><span class="hl-9">.</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3"> esta en </span><span class="hl-6">${</span><span class="hl-2">x</span><span class="hl-6">}</span><span class="hl-3"> lineas del fichero`</span><span class="hl-1">));</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">`La palabra </span><span class="hl-6">${</span><span class="hl-6">this</span><span class="hl-9">.</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3"> no se encuentra en el fichero`</span><span class="hl-1">));</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;El fichero no existe&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span>
</code></pre>
<p>En el programa main se añade la funcionalidad con yargs como la siguiente: </p>
<pre><code class="language-typescript"><span class="hl-10">/**</span><br/><span class="hl-10"> * Yargs con tuberia</span><br/><span class="hl-10"> */</span><br/><span class="hl-2">yargs</span><span class="hl-1">.</span><span class="hl-5">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;pipe&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Grep de un fichero con tuperia&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">file:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;file&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">word:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;word&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">handler</span><span class="hl-1">(</span><span class="hl-2">argv</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">file</span><span class="hl-1"> === </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">typeof</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">word</span><span class="hl-1"> === </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1"> &amp;&amp; </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> === </span><span class="hl-4">5</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pipeFunction</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">GrepCommand</span><span class="hl-1">(</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">file</span><span class="hl-1">, </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">word</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">pipeFunction</span><span class="hl-1">.</span><span class="hl-5">pipe</span><span class="hl-1">())</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;Argumentos inválidos&#39;</span><span class="hl-1">))</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
<pre><code class="language-bash"><span class="hl-2">$node</span><span class="hl-1"> dist/ejercicio-2/main.js nopipe --file=</span><span class="hl-3">&quot;/home/usuario/prct10/src/ejercicio-2/prueba.txt&quot;</span><span class="hl-1"> --word=</span><span class="hl-3">&quot;Hola&quot;</span>
</code></pre>
<pre><code class="language-bash"><span class="hl-1">[~/prct10(master)]</span><span class="hl-2">$node</span><span class="hl-1"> dist/ejercicio-2/main.js nopipe --file=</span><span class="hl-3">&quot;archivoNoExistente.txt&quot;</span><span class="hl-1"> --word=</span><span class="hl-3">&quot;Hola&quot;</span><br/><span class="hl-1">El fichero no existe</span><br/><span class="hl-1">[~/prct10(master)]</span><span class="hl-2">$node</span><span class="hl-1"> dist/ejercicio-2/main.js nopipe --file=</span><span class="hl-3">&quot;/home/usuario/prct10/src/ejercicio-2/prueba.txt&quot;</span><span class="hl-1"> --word=</span><span class="hl-3">&quot;Hola&quot;</span><br/><span class="hl-1">Hola esta en 2 lineas del fichero</span>
</code></pre>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="modules/ejercicio_2_grepCommand.html">ejercicio-<wbr/>2/grep<wbr/>Command</a></li><li class=" tsd-kind-module"><a href="modules/ejercicio_3_ejercicio_3.html">ejercicio-<wbr/>3/ejercicio-<wbr/>3</a></li><li class=" tsd-kind-module"><a href="modules/ejercicio_3_managerNote.html">ejercicio-<wbr/>3/manager<wbr/>Note</a></li><li class=" tsd-kind-module"><a href="modules/ejercicio_3_note.html">ejercicio-<wbr/>3/note</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>